Vagrant.configure("2") do |config|
  config.vm.define "vm1" do |machine|
    machine.vm.box = "hashicorp/bionic64"
    machine.vm.network "private_network", type: "dhcp"
    machine.vm.hostname = "vm1"

    machine.vm.provision "shell", inline: <<-SHELL
      # Actualizar paquetes e instalar herramientas
      apt-get update
      apt-get install -y net-tools debconf-utils joe zip libc-dev-bin build-essential default-jdk

      # Alias para ls
      grep -q "alias ls='ls -la'" /home/vagrant/.bashrc || echo -e "\\nalias ls='ls -la'" >> /home/vagrant/.bashrc

     echo $(hostname -I | awk '{print $2}') > /vagrant/server_ip.txt
     gcc /vagrant/client_10_seg.c -o /home/vagrant/server
     nohup /home/vagrant/server > /vagrant/server.log 2>&1 &

    SHELL

  end
end
